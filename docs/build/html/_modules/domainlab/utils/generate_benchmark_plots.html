
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#2196f3">
  <script src="../../../_static/javascripts/modernizr.js"></script>
  
  
    <link rel="apple-touch-icon" href="../../../_static/images/apple-icon-152x152.png"/>
  
  
    <title>domainlab.utils.generate_benchmark_plots &#8212; domainlab  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/material.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  
    <link rel="apple-touch-icon" href="../../../_static/images/apple-icon-152x152.png"/>
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=teal data-md-color-accent=cyan>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#_modules/domainlab/utils/generate_benchmark_plots" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../index.html" title="domainlab  documentation"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">school</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">DomainLab</span>
          <span class="md-header-nav__topic"> domainlab.utils.generate_benchmark_plots </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/marrlab/DomainLab" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    DomainLab
  </div>
</a>
          </div>
        </div>
      
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
            
            <li class="md-tabs__item"><a href="../../../readme_link.html" class="md-tabs__link">Introduction</a></li>
            
            <li class="md-tabs__item"><a href="../../../doc_tasks.html" class="md-tabs__link">Task Specification</a></li>
            
            <li class="md-tabs__item"><a href="../../../doc_custom_nn.html" class="md-tabs__link">Custom Neural Network</a></li>
            
            <li class="md-tabs__item"><a href="../../../doc_MNIST_classification.html" class="md-tabs__link">Examples with MNIST</a></li>
            
            <li class="md-tabs__item"><a href="../../../doc_examples.html" class="md-tabs__link">Examples by algorithm</a></li>
            
            <li class="md-tabs__item"><a href="../../../doc_benchmark.html" class="md-tabs__link">Benchmarks</a></li>
            
            <li class="md-tabs__item"><a href="../../../doc_output.html" class="md-tabs__link">Output Structure</a></li>
            
            <li class="md-tabs__item"><a href="../../../doc_extend_contribute.html" class="md-tabs__link">Extend and Contribute</a></li>
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">Module code</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../index.html" title="domainlab documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">school</i>
      
    </a>
    <a href="../../../index.html"
       title="domainlab documentation">DomainLab</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/marrlab/DomainLab" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    DomainLab
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Contents:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../modules.html" class="md-nav__link">domainlab</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../doc_algos.html" class="md-nav__link">Overview of implemented models and algorithms</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../docHDUVA.html" class="md-nav__link">HDUVA: HIERARCHICAL VARIATIONAL AUTO-ENCODING FOR UNSUPERVISED DOMAIN GENERALIZATION</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../docJiGen.html" class="md-nav__link">JiGen</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../doc_diva.html" class="md-nav__link">DIVA: Domain Invariant Variational Autoencoders</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../docMatchDG.html" class="md-nav__link">MatchDG: Domain Generalization using Causal Matching</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../../../docDIAL.html" class="md-nav__link">DIAL: Domain Invariant Adversarial Learning</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <h1 id="modules-domainlab-utils-generate-benchmark-plots--page-root">Source code for domainlab.utils.generate_benchmark_plots</h1><div class="highlight"><pre>
<span></span>'''
generate the benchmark plots by calling the gen_bencmark_plots(...) function
'''
import os
from ast import literal_eval   # literal_eval can safe evaluate python expression
import matplotlib.pyplot as plt
import matplotlib
import pandas as pd
import seaborn as sns
import numpy as np
from domainlab.utils.logger import Logger

matplotlib.use('Agg')

# header of the csv file:
# param_index, task, algo, epos, te_d, seed, params, acc, precision, recall, specificity, f1, auroc

COLNAME_METHOD = "method"
COLNAME_IDX_PARAM = "param_index"
COLNAME_PARAM = "params"
G_DF_TASK_COL = 1   # column in which the task name is saved
G_DF_PLOT_COL_METRIC_START = 7   # first 0-6 columns are not metric



<div class="viewcode-block" id="gen_benchmark_plots"><a class="viewcode-back" href="../../../domainlab.utils.html#domainlab.utils.generate_benchmark_plots.gen_benchmark_plots">[docs]</a>def gen_benchmark_plots(agg_results: str, output_dir: str, use_param_index: bool = True):
    '''
    generate the benchmark plots from a csv file containing the aggregated restults.
    The csv file must have the columns:
    [param_index, task, algo, epos, te_d, seed, params, ...]
    all columns after seed are intrepreted as objectives of the results, they can e.g.
    be acc, precision, recall, specificity, f1, auroc.

    agg_results: path to the csv file
    output_dir: path to a folder which shall contain the results
    skip_gen: Skips the actual plotting, used to speed up testing.
    '''
    raw_df = pd.read_csv(agg_results, index_col=False,
                         converters={COLNAME_PARAM: literal_eval},
                         # literal_eval can safe evaluate python expression
                         skipinitialspace=True)

    raw_df[COLNAME_PARAM] = round_vals_in_dict(raw_df[[COLNAME_IDX_PARAM, COLNAME_PARAM]],
                                               use_param_index)

    # generating plot
    gen_plots(raw_df, output_dir, use_param_index)</div>


<div class="viewcode-block" id="round_vals_in_dict"><a class="viewcode-back" href="../../../domainlab.utils.html#domainlab.utils.generate_benchmark_plots.round_vals_in_dict">[docs]</a>def round_vals_in_dict(df_column_in, use_param_index):
    '''
    replaces the dictionary by a string containing only the significant digits of the hyperparams
    or (if use_param_index = True) by the parameter index
    df_column_in: columns of the dataframe containing the param index and the dictionary of
        hyperparams in the form [param_index, params]
    use_param_index: usage of param_index instead of exact values
    '''
    df_column = df_column_in.copy()
    df_column_out = df_column_in[COLNAME_IDX_PARAM].copy()
    df_column_out = df_column_out.astype(str)
    for i in range(df_column.shape[0]):
        if not use_param_index:
            string = ''
            for num, val in enumerate(list(df_column[COLNAME_PARAM][i].values())):
                key = list(df_column[COLNAME_PARAM][i].keys())[num]
                val = np.format_float_scientific(val, precision=1, unique=False, trim='0')
                string += str(key) + ': ' + str(val) + ', '
            df_column_out[i] = string[:-2]  # remove ', ' from the end of the string
        else:
            string = 'idx: ' + str(df_column[COLNAME_IDX_PARAM][i])
            df_column_out[i] = string
    return df_column_out</div>


<div class="viewcode-block" id="gen_plots"><a class="viewcode-back" href="../../../domainlab.utils.html#domainlab.utils.generate_benchmark_plots.gen_plots">[docs]</a>def gen_plots(dataframe: pd.DataFrame, output_dir: str, use_param_index: bool):
    '''
    dataframe: dataframe with columns
    ['param_index','task',' algo',' epos',' te_d',' seed',' params',' acc','precision',...]
    '''
    os.makedirs(output_dir, exist_ok=True)
    obj = dataframe.columns[G_DF_PLOT_COL_METRIC_START:]

    # boxplots
    for objective in obj:
        boxplot(dataframe, objective, file=output_dir + '/variational_plots/' + objective)

    # scatterplot matrices
    scatterplot_matrix(dataframe, use_param_index,
                       file=output_dir + '/sp_matrix_reg.png',
                       kind='reg', distinguish_param_setups=False)
    scatterplot_matrix(dataframe, use_param_index,
                       file=output_dir + '/sp_matrix.png',
                       kind='scatter', distinguish_param_setups=False)
    scatterplot_matrix(dataframe, use_param_index,
                       file=output_dir + '/sp_matrix_dist_reg.png',
                       kind='reg', distinguish_param_setups=True)
    scatterplot_matrix(dataframe, use_param_index,
                       file=output_dir + '/sp_matrix_dist.png',
                       kind='scatter', distinguish_param_setups=True)

    # radar plots
    radar_plot(dataframe, file=output_dir + '/radar_dist.png', distinguish_hyperparam=True)
    radar_plot(dataframe, file=output_dir + '/radar.png', distinguish_hyperparam=False)

    # scatter plots for parirs of objectives
    os.makedirs(output_dir + '/scatterpl', exist_ok=True)
    for i, obj_i in enumerate(obj):
        for j in range(i+1, len(obj)):
            try:
                scatterplot(dataframe, [obj_i, obj[j]],
                            file=output_dir + '/scatterpl/' + obj_i + '_' + obj[j] + '.png')
            except IndexError:
                logger = Logger.get_logger()
                logger.warning(f'disabling kde because cov matrix is singular for objectives '
                               f'{obj_i} &amp; {obj[j]}')
                scatterplot(dataframe, [obj_i, obj[j]],
                            file=output_dir + '/scatterpl/' + obj_i + '_' + obj[j] + '.png',
                            kde=False)

    # create plots for the different algortihms
    for algorithm in dataframe[COLNAME_METHOD].unique():
        os.makedirs(output_dir + '/' + str(algorithm), exist_ok=True)
        dataframe_algo = dataframe[dataframe[COLNAME_METHOD] == algorithm]

        # boxplots
        for objective in obj:
            boxplot(dataframe_algo, objective,
                    file=output_dir + '/' + str(algorithm) + '/variational_plots/' + objective)

        # scatterplot matrices
        scatterplot_matrix(dataframe_algo, use_param_index,
                           file=output_dir + '/' + str(algorithm) + '/sp_matrix_reg.png',
                           kind='reg', distinguish_param_setups=False)
        scatterplot_matrix(dataframe_algo, use_param_index,
                           file=output_dir + '/' + str(algorithm) + '/sp_matrix.png',
                           kind='scatter', distinguish_param_setups=False)
        scatterplot_matrix(dataframe_algo, use_param_index,
                           file=output_dir + '/' + str(algorithm) + '/sp_matrix_dist_reg.png',
                           kind='reg', distinguish_param_setups=True)
        scatterplot_matrix(dataframe_algo, use_param_index,
                           file=output_dir + '/' + str(algorithm) + '/sp_matrix_dist.png',
                           kind='scatter', distinguish_param_setups=True)

        # radar plots
        radar_plot(dataframe_algo, file=output_dir + '/' + str(algorithm) + '/radar_dist.png',
                   distinguish_hyperparam=True)
        radar_plot(dataframe_algo, file=output_dir + '/' + str(algorithm) + '/radar.png',
                   distinguish_hyperparam=False)

        # scatter plots for parirs of objectives
        os.makedirs(output_dir + '/' + str(algorithm) + '/scatterpl', exist_ok=True)
        for i, obj_i in enumerate(obj):
            for j in range(i + 1, len(obj)):
                try:
                    scatterplot(dataframe_algo, [obj_i, obj[j]],
                                file=output_dir + '/' + str(algorithm) +
                                '/scatterpl/' + obj_i + '_' + obj[j] + '.png',
                                distinguish_hyperparam=True)
                except IndexError:
                    logger = Logger.get_logger()
                    logger.warning(f'WARNING: disabling kde because cov matrix is singular '
                                   f'for objectives {obj_i} &amp; {obj[j]}')
                    scatterplot(dataframe_algo, [obj_i, obj[j]],
                                file=output_dir + '/' + str(algorithm) +
                                '/scatterpl/' + obj_i + '_' + obj[j] + '.png',
                                kde=False,
                                distinguish_hyperparam=True)</div>


<div class="viewcode-block" id="scatterplot_matrix"><a class="viewcode-back" href="../../../domainlab.utils.html#domainlab.utils.generate_benchmark_plots.scatterplot_matrix">[docs]</a>def scatterplot_matrix(dataframe_in, use_param_index, file=None, kind='reg',
                       distinguish_param_setups=True):
    '''
    dataframe: dataframe containing the data with columns
        [algo, epos, te_d, seed, params, obj1, ..., obj2]
    file: filename to save the plots (if None, the plot will not be saved)
    reg: if True a regression line will be plotted over the data
    distinguish_param_setups: if True the plot will not only distinguish between models,
        but also between the parameter setups
    '''
    dataframe = dataframe_in.copy()
    index = list(range(G_DF_PLOT_COL_METRIC_START, dataframe.shape[1]))
    if distinguish_param_setups:
        dataframe_ = dataframe.iloc[:, index]
        dataframe_.insert(0, 'label',
                          dataframe[COLNAME_METHOD].astype(str) + ', ' +
                          dataframe[COLNAME_PARAM].astype(str))

        g_p = sns.pairplot(data=dataframe_, hue='label', corner=True, kind=kind)
    else:
        index_ = list(range(G_DF_PLOT_COL_METRIC_START, dataframe.shape[1]))
        index_.insert(0, G_DF_TASK_COL)
        dataframe_ = dataframe.iloc[:, index_]

        g_p = sns.pairplot(data=dataframe_, hue=COLNAME_METHOD, corner=True, kind=kind)

    for i in range(len(index)):
        for j in range(len(index)):
            if i &gt;= j:
                g_p.axes[i, j].set_xlim((-0.1, 1.1))
                for k in range(j):
                    g_p.axes[j, k].set_ylim((-0.1, 1.1))

    g_p.fig.set_size_inches(12.5, 12)
    if use_param_index and distinguish_param_setups:
        sns.move_legend(g_p, loc='upper right', bbox_to_anchor=(1., 1.), ncol=3)
    else:
        sns.move_legend(g_p, loc='upper right', bbox_to_anchor=(1., 1.), ncol=1)
    plt.tight_layout()

    if file is not None:
        plt.savefig(file, dpi=300)</div>


<div class="viewcode-block" id="scatterplot"><a class="viewcode-back" href="../../../domainlab.utils.html#domainlab.utils.generate_benchmark_plots.scatterplot">[docs]</a>def scatterplot(dataframe_in, obj, file=None, kde=True, distinguish_hyperparam=False):
    '''
    dataframe: dataframe containing the data with columns
        [algo, epos, te_d, seed, params, obj1, ..., obj2]
    obj1 &amp; obj2: name of the objectives which shall be plotted against each other
    file: filename to save the plots (if None, the plot will not be saved)
    kde: if True the distribution of the points will be estimated and plotted as kde plot
    distinguish_param_setups: if True the plot will not only distinguish between models,
        but also between the parameter setups
    '''
    obj1, obj2 = obj

    dataframe = dataframe_in.copy()
    dataframe[COLNAME_PARAM] = dataframe[COLNAME_PARAM].astype(str)

    if distinguish_hyperparam:
        if kde:
            g_p = sns.jointplot(data=dataframe, x=obj1, y=obj2, hue=COLNAME_PARAM,
                                xlim=(-0.1, 1.1), ylim=(-0.1, 1.1), kind='kde',
                                zorder=0, levels=8, alpha=0.35, warn_singular=False)
            gg_p = sns.scatterplot(data=dataframe, x=obj1, y=obj2, hue=COLNAME_PARAM,
                                   ax=g_p.ax_joint)
        else:
            g_p = sns.jointplot(data=dataframe, x=obj1, y=obj2, hue=COLNAME_PARAM,
                                xlim=(-0.1, 1.1), ylim=(-0.1, 1.1))
            gg_p = g_p.ax_joint
    else:
        if kde:
            g_p = sns.jointplot(data=dataframe, x=obj1, y=obj2, hue=COLNAME_METHOD,
                                xlim=(-0.1, 1.1), ylim=(-0.1, 1.1), kind='kde',
                                zorder=0, levels=8, alpha=0.35, warn_singular=False)
            gg_p = sns.scatterplot(data=dataframe, x=obj1, y=obj2, hue=COLNAME_METHOD,
                                   style=COLNAME_PARAM,
                                   ax=g_p.ax_joint)
        else:
            g_p = sns.jointplot(data=dataframe, x=obj1, y=obj2, hue=COLNAME_METHOD,
                                xlim=(-0.1, 1.1), ylim=(-0.1, 1.1))
            gg_p = sns.scatterplot(data=dataframe, x=obj1, y=obj2, style=COLNAME_PARAM,
                                   ax=g_p.ax_joint)

    gg_p.set_aspect('equal')
    gg_p.legend(fontsize=6, loc='best')

    if file is not None:
        plt.savefig(file, dpi=300)</div>


<div class="viewcode-block" id="max_0_x"><a class="viewcode-back" href="../../../domainlab.utils.html#domainlab.utils.generate_benchmark_plots.max_0_x">[docs]</a>def max_0_x(x_arg):
    '''
    max(0, x_arg)
    '''
    return max(0, x_arg)</div>


<div class="viewcode-block" id="radar_plot"><a class="viewcode-back" href="../../../domainlab.utils.html#domainlab.utils.generate_benchmark_plots.radar_plot">[docs]</a>def radar_plot(dataframe_in, file=None, distinguish_hyperparam=True):
    '''
    dataframe_in: dataframe containing the data with columns
        [algo, epos, te_d, seed, params, obj1, ..., obj2]
    file: filename to save the plots (if None, the plot will not be saved)
    distinguish_param_setups: if True the plot will not only distinguish between models,
        but also between the parameter setups
    '''
    dataframe = dataframe_in.copy()
    if distinguish_hyperparam:
        dataframe.insert(0, 'label',
                         dataframe[COLNAME_METHOD].astype(str) + ', ' +
                         dataframe[COLNAME_PARAM].astype(str))
    else:
        dataframe.insert(0, 'label', dataframe[COLNAME_METHOD])
    # we need "G_DF_PLOT_COL_METRIC_START + 1" as we did insert the columns 'label' at index 0
    index = list(range(G_DF_PLOT_COL_METRIC_START + 1, dataframe.shape[1]))
    num_lines = len(dataframe['label'].unique())
    _, axis = plt.subplots(figsize=(9, 9 + (0.28 * num_lines)), subplot_kw=dict(polar=True))
    num = 0

    # Split the circle into even parts and save the angles
    # so we know where to put each axis.
    angles = list(np.linspace(0, 2 * np.pi, len(dataframe.columns[index]), endpoint=False))
    for algo_name in dataframe['label'].unique():
        mean = dataframe.loc[dataframe['label'] == algo_name].iloc[:, index].mean().to_list()
        std = dataframe.loc[dataframe['label'] == algo_name].iloc[:, index].std().to_list()

        angles_ = angles
        # The plot is a circle, so we need to "complete the loop"
        # and append the start value to the end.
        mean = np.array(mean + mean[:1])
        std = np.array(std + std[:1])
        angles_ = np.array(angles_ + angles_[:1])

        # Draw the outline of the data.
        axis.plot(angles_, mean,
                  color=list(plt.rcParams["axes.prop_cycle"])[num]['color'],
                  linewidth=2, label=algo_name)

        # Fill it in.
        axis.fill_between(angles_, list(map(max_0_x, mean - std)),
                          y2=mean + std,
                          color=list(plt.rcParams["axes.prop_cycle"])[num]['color'],
                          alpha=0.1)
        num += 1
        num = num % len(list(plt.rcParams["axes.prop_cycle"]))

    # Fix axis to go in the right order and start at 12 o'clock.
    axis.set_theta_offset(np.pi / 2)
    axis.set_theta_direction(-1)

    # Draw axis lines for each angle and label.
    axis.set_thetagrids(np.degrees(angles), dataframe.columns[index])

    axis.set_ylim((0, 1))

    plt.legend(loc='lower right', bbox_to_anchor=(1., 1.035),
               ncol=1, fontsize=10)

    if file is not None:
        plt.savefig(file, dpi=300)</div>


<div class="viewcode-block" id="boxplot"><a class="viewcode-back" href="../../../domainlab.utils.html#domainlab.utils.generate_benchmark_plots.boxplot">[docs]</a>def boxplot(dataframe_in, obj, file=None):
    '''
    generate the boxplots
    dataframe_in: dataframe containing the data with columns
        [param_idx, task , algo, epos, te_d, seed, params, obj1, ..., obj2]
    obj: objective to be considered in the plot (needs to be contained in dataframe_in)
    file: foldername to save the plots (if None, the plot will not be saved)
    '''
    boxplot_stochastic(dataframe_in, obj, file=file)
    boxplot_systematic(dataframe_in, obj, file=file)</div>

<div class="viewcode-block" id="boxplot_stochastic"><a class="viewcode-back" href="../../../domainlab.utils.html#domainlab.utils.generate_benchmark_plots.boxplot_stochastic">[docs]</a>def boxplot_stochastic(dataframe_in, obj, file=None):
    '''
    generate boxplot for stochastic variation
    dataframe_in: dataframe containing the data with columns
        [param_idx, task , algo, epos, te_d, seed, params, obj1, ..., obj2]
    obj: objective to be considered in the plot (needs to be contained in dataframe_in)
    file: foldername to save the plots (if None, the plot will not be saved)
    '''
    dataframe = dataframe_in.copy()
    os.makedirs(file, exist_ok=True)

    ### stochastic variation
    _, axes = plt.subplots(1, len(dataframe[COLNAME_METHOD].unique()), sharey=True,
                           figsize=(3 * len(dataframe[COLNAME_METHOD].unique()), 6))
    # iterate over all algorithms
    for num, algo in enumerate(list(dataframe[COLNAME_METHOD].unique())):
        # distinguish if the algorithm does only have one param setup or multiple
        if len(dataframe[COLNAME_METHOD].unique()) &gt; 1:
            # generate boxplot and swarmplot
            sns.boxplot(data=dataframe[dataframe[COLNAME_METHOD] == algo],
                        x=COLNAME_IDX_PARAM, y=obj,
                        ax=axes[num], showfliers=False,
                        boxprops={"facecolor": (.4, .6, .8, .5)})
            sns.swarmplot(data=dataframe[dataframe[COLNAME_METHOD] == algo],
                          x=COLNAME_IDX_PARAM, y=obj, hue=COLNAME_IDX_PARAM,
                          legend=False, ax=axes[num],
                          palette=sns.cubehelix_palette(n_colors=len(
                              dataframe[dataframe[COLNAME_METHOD] == algo]
                              [COLNAME_IDX_PARAM].unique())))
            # remove legend, set ylim, set x-label and remove y-label
            axes[num].legend([], [], frameon=False)
            axes[num].set_ylim([-0.1, 1.1])
            axes[num].set_xlabel(algo)
            if num != 0:
                axes[num].set_ylabel('')
        else:
            sns.boxplot(data=dataframe[dataframe[COLNAME_METHOD] == algo],
                        x=COLNAME_IDX_PARAM, y=obj,
                        ax=axes, showfliers=False,
                        boxprops={"facecolor": (.4, .6, .8, .5)})
            sns.swarmplot(data=dataframe[dataframe[COLNAME_METHOD] == algo],
                          x=COLNAME_IDX_PARAM, y=obj, hue=COLNAME_IDX_PARAM,
                          legend=False, ax=axes,
                          palette=sns.cubehelix_palette(n_colors=len(
                              dataframe[dataframe[COLNAME_METHOD] == algo]
                              [COLNAME_IDX_PARAM].unique())))
            axes.legend([], [], frameon=False)
            axes.set_ylim([-0.1, 1.1])
            axes.set_xlabel(algo)
        plt.tight_layout()
        if file is not None:
            plt.savefig(file + '/stochastic_variation.png', dpi=300)</div>


<div class="viewcode-block" id="boxplot_systematic"><a class="viewcode-back" href="../../../domainlab.utils.html#domainlab.utils.generate_benchmark_plots.boxplot_systematic">[docs]</a>def boxplot_systematic(dataframe_in, obj, file=None):
    '''
    generate boxplot for ssystemtic variation
    dataframe_in: dataframe containing the data with columns
        [param_idx, task , algo, epos, te_d, seed, params, obj1, ..., obj2]
    obj: objective to be considered in the plot (needs to be contained in dataframe_in)
    file: foldername to save the plots (if None, the plot will not be saved)
    '''
    dataframe = dataframe_in.copy()
    os.makedirs(file, exist_ok=True)

    ### systematic variation
    _, axes = plt.subplots(1, len(dataframe[COLNAME_METHOD].unique()), sharey=True,
                           figsize=(3 * len(dataframe[COLNAME_METHOD].unique()), 6))

    for num, algo in enumerate(list(dataframe[COLNAME_METHOD].unique())):
        # distinguish if the algorithm does only have one param setup or multiple
        if len(dataframe[COLNAME_METHOD].unique()) &gt; 1:
            # generate boxplot and swarmplot
            sns.boxplot(data=dataframe[dataframe[COLNAME_METHOD] == algo],
                        x=COLNAME_METHOD, y=obj,
                        ax=axes[num], showfliers=False,
                        boxprops={"facecolor": (.4, .6, .8, .5)})
            sns.swarmplot(data=dataframe[dataframe[COLNAME_METHOD] == algo],
                          x=COLNAME_METHOD, y=obj, hue=COLNAME_IDX_PARAM,
                          legend=False, ax=axes[num],
                          palette=sns.cubehelix_palette(n_colors=len(
                              dataframe[dataframe[COLNAME_METHOD] == algo]
                              [COLNAME_IDX_PARAM].unique())))
            # remove legend, set ylim, set x-label and remove y-label
            axes[num].legend([], [], frameon=False)
            axes[num].set_ylim([-0.1, 1.1])
            axes[num].set_xlabel(' ')
            if num != 0:
                axes[num].set_ylabel('')
        else:
            sns.boxplot(data=dataframe[dataframe[COLNAME_METHOD] == algo],
                        x=COLNAME_METHOD, y=obj,
                        ax=axes, showfliers=False,
                        boxprops={"facecolor": (.4, .6, .8, .5)})
            sns.swarmplot(data=dataframe[dataframe[COLNAME_METHOD] == algo],
                          x=COLNAME_METHOD, y=obj, hue=COLNAME_IDX_PARAM,
                          legend=False, ax=axes,
                          palette=sns.cubehelix_palette(n_colors=len(
                              dataframe[dataframe[COLNAME_METHOD] == algo]
                              [COLNAME_IDX_PARAM].unique())))
            axes.legend([], [], frameon=False)
            axes.set_ylim([-0.1, 1.1])
            axes.set_xlabel(' ')
        plt.tight_layout()

    if file is not None:
        plt.savefig(file + '/systematic_variation.png', dpi=300)</div>

</pre></div>

          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2021-2023, Marr Lab..
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>