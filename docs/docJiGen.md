# JiGen

The JiGen method proposed in [https://arxiv.org/abs/2007.01434](https://arxiv.org/abs/1903.06864) by Carlucci et al. extends the understanding of the concept of spatial correlation in the neuronal network by training the network not only on a classification task, but also on jigsaw puzzles. For the jigsaw puzzles the images are split into $n \times n$ patches and permutated. The target of the model is to predict the Hamming distance between the permutation and the original image. For controlling the complexity of the jigsaw puzzle the network parameter $P$ bounds the maximal allowed Hamming distance between shuffled image and ordered image.
To be able to solve the classification problem and the jigsaw puzzle in parallel, shuffled and ordered images will first be fed into a convolutional network for feature extraction and will then be given to the image classifier or the jigsaw classifier according to the type of the initial input.
For the training of the network one uses a cross-entropy loss for both tasks while weighting the jigsaw classifier by a hyper parameter $\alpha$. Additionally the relative ratio of ordered images in the training data set is given by another hyper parameter $\beta$.
The advantage of this method is, that it can be extended to new domains where only a unlabeled data set is available, as the jigsaw puzzle can be solved despite the missing labels. On this new domain the authors use the empirical entropy loss for the classification task to minimize the classifier prediction uncertainty and keep the cross-entropy for the jigsaw loss. Alike before, the empirical entropy loss is weighted by another hyper parameter $\eta$.
During experiments this method outperformed various other recent methods used in the area of domain generalisation. However, the key for a good performance seems to a the right configuration of the hyper parameters. The authors of the paper tune their parameters using cross-validation on a $10~\%$ subset of the source. Given that one has no access to the target domain such tuning is impossible in the real world application. 
